<div class="card-deploy">
  <div class="card_header">
    <h3>Step {{$ctrl.step}}</h3>
    <i class="fa fa-trash-o" ng-show="allowDelete" ng-click="handleDeleteCard()"/>
  </div>
  <hr/>
  <div style="margin-bottom: 10px;">
    <span>Choose domain:</span>
    <select style="width: 170px" ng-disabled="isDisabledFields" ng-model="domain" ng-change="setDomain()">
      <option ng-repeat="(key, domain) in domainsList">{{domain}}</option>
    </select>
    <span>Choose action:</span>
    <select style="width: 170px" ng-disabled="isDisabledFields" ng-model="action" ng-change="setAction()">
      <option ng-repeat="act in actionsList" ng-value="act.id">{{act.name}}</option>
    </select>
    <div>
      <input id="picker" ng-disabled="isDisabledFields" type="checkbox" ng-model="ispicker" ng-change="setPicker()"/>
      <label for="picker">Composer step</label>
    </div>
    <div>
      <input id="setuper" ng-disabled="isDisabledFields" type="checkbox" ng-model="isdeployer" ng-change="setDeployer()"/>
      <label for="setuper">Deployer step</label>
    </div>
    <div
      class="play-button"
      ng-class="{disabledButton: !domain || prevStepNotComplited}"
      ng-if="final === undefined && status === 'start' && allowRun"
      ng-click="deployConfig($ctrl.index)"
    >
      <i class="fa fa-play-circle"></i>
    </div>
    <div class="success-button" ng-if="status === 'successful'">
      <i class="fa fa-check-circle-o"></i>
    </div>
    <div class="failed-button" ng-if="status === 'failed'">
      <i class="fa fa-times-circle-o"></i>
    </div>
    <div
      class="DashboardGraphs error"
      ng-if="final.status === 'failed'"
      style="background-color: #f8d7da;
    border: 1px solid #f5c6cb; padding-bottom: 20px;"
    >
      <i class="fa fa-warning"></i> Something went wrong. See log
      <a ng-href="#/jobs/playbook/{{final['job']}}">here...</a>
    </div>
    <div
      class="gear"
      ng-if="final === null && status !== 'failed' && status !== 'successful' || status === 'pending'"
    ></div>
  </div>
  <div class="popup" ng-show="showPopup">
    <div class="popup-content" style="width: 86%;">
      <div class="popup-header">
        <span class="close" ng-click="closePopup()">&times;</span>
        <h4>Upcoming changes</h4>
      </div>
      <div class="popup-body">
        <div style="overflow: auto; max-height: 400px;">
          <div class="DashboardGraphs" ng-show="commitStrings" style="text-align: left; padding: 20px 10px; margin-bottom: 20px;">
            <div ng-repeat="str in commitStrings">
              {{str}}
            </div>
            <div ng-repeat="hash in commitHashStr">
              {{hash}}
            </div>
          </div>
        </div>
        <button class="btn btn-primary" ng-click="confirmChanges()">
          <i class="fa fa-play-circle"></i>
          <span>Apply</span>
        </button>
        <button class="btn" ng-click="declaimChanges()" ng-if="!showCompleted">
          <span>Cancel</span>
        </button>
      </div>
    </div>
  </div>
</div>
